import{d as L,r as I,o as z,a as E,c as A,w as l,b as e,u as n,e as r,f as W,g as C,E as V,h,i as q,j as le,k as O,l as j,m as G,n as K,p as Q,q as X,s as Z,t as ee,v as oe,x as ne,y as J,z as P,A as R,B as be,C as te,D as ye,F as ge,G as ie,H as de,I as we,J as ve,K as xe,L as Ve,M as Ce,N as ke,O as Ue,_ as Ye}from"./index-jH42E5tC.js";/* empty css                */const $e={class:"dialog-footer"},De=L({__name:"Account",setup(F){let i=I({mode:0,user_dialog_visible:!1,active_name:"accoutManage",user_list:Array(),is_admin:!0}),t=I({id:0,name:"",pwd:"",desc_info:"",is_admin:"N",is_enable:"Y",is_root:"N",expiry_at:new Date(2050,0,0,0,0,0)});function w(d=0,o=1e4){C.get(`/api/user?offset=${d}&limit=${o}`).then(m=>{m.data.code===0?i.user_list=m.data.data:V.error("获取用户列表错误")})}function v(){t.id=0,t.name="",t.pwd="",t.desc_info="",t.is_admin="N",t.is_enable="Y",t.is_root="N",t.expiry_at=new Date(2050,0,0,0,0,0),i.user_dialog_visible=!0}function f(d){t.id=d.id,t.name=d.name,t.pwd=d.pwd,t.desc_info=d.desc_info,t.is_admin=d.is_admin,t.is_enable=d.is_enable,t.is_root=d.is_root,t.expiry_at=d.expiry_at,i.user_dialog_visible=!0}function u(){return{id:t.id,name:t.name,pwd:t.pwd,desc_info:t.desc_info,is_admin:t.is_admin,is_enable:t.is_enable,is_root:t.is_root,expiry_at:P(t.expiry_at).format("YYYY-MM-DD HH:mm:ss")}}function Y(){C.put("/api/user",u()).then(d=>{d.data.code===0?i.user_list=d.data.data:V.error("更新用户错误,请检查输入")})}function _(d){C.delete(`/api/user/${d}`).then(o=>{o.data.code===0?i.user_list=o.data.data:V.error("删除用户错误")})}function $(){C.post("/api/user",u()).then(d=>{d.data.code===0?i.user_list=d.data.data:V.error("创建用户错误,请检查输入")})}function B(){t.id===0?$():Y(),t.id=0,t.name="",t.pwd="",t.desc_info="",t.is_admin="N",t.is_enable="Y",t.is_root="N",t.expiry_at=new Date(2050,0,0,0,0,0),i.user_dialog_visible=!1}return z(()=>{w()}),(d,o)=>{const m=h,c=q,T=le,p=O,a=j,k=G,U=K,b=Q,x=X,D=Z,y=ee,H=oe,N=ne,S=J;return E(),A(S,{label:"Web账号配置",name:"accoutManage"},{default:l(()=>[e(k,null,{default:l(()=>[e(a,null,{default:l(()=>[e(p,{data:n(i).user_list,style:{width:"100%"},"show-overflow-tooltip":!0},{default:l(()=>[e(m,{fixed:"",sortable:"",prop:"name",label:"用户名"}),e(m,{sortable:"",prop:"desc_info",label:"备注信息",width:"200"}),e(m,{sortable:"",prop:"is_admin",label:"是否管理员"}),e(m,{sortable:"",prop:"is_enable",label:"是否启用"}),e(m,{sortable:"",prop:"expiry_at",label:"过期时间",width:"180"}),e(m,{fixed:"right",label:"操作"},{header:l(()=>[e(c,{type:"primary",onClick:v},{default:l(()=>o[9]||(o[9]=[r("新增")])),_:1}),e(c,{type:"primary",onClick:o[0]||(o[0]=s=>w(0,1e4))},{default:l(()=>o[10]||(o[10]=[r("刷新")])),_:1})]),default:l(s=>[e(c,{type:"success",onClick:M=>f(s.row)},{default:l(()=>o[11]||(o[11]=[r("编辑")])),_:2},1032,["onClick"]),e(T,{confirmButtonText:"删除",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"确定删除吗",onConfirm:M=>_(s.row.id)},{reference:l(()=>[e(c,{type:"danger"},{default:l(()=>o[12]||(o[12]=[r("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),e(N,{title:"用户信息",modelValue:n(i).user_dialog_visible,"onUpdate:modelValue":o[8]||(o[8]=s=>n(i).user_dialog_visible=s),width:"60%"},{footer:l(()=>[W("span",$e,[e(c,{onClick:o[7]||(o[7]=s=>n(i).user_dialog_visible=!1)},{default:l(()=>o[17]||(o[17]=[r("取消")])),_:1}),e(c,{type:"success",onClick:B},{default:l(()=>o[18]||(o[18]=[r("保存")])),_:1})])]),default:l(()=>[e(H,{"label-width":"80px"},{default:l(()=>[e(b,{label:"备注名",prop:"desc_info"},{default:l(()=>[e(U,{minlength:"1",maxlength:"60",modelValue:n(t).desc_info,"onUpdate:modelValue":o[1]||(o[1]=s=>n(t).desc_info=s),modelModifiers:{trim:!0},"show-word-limit":"",placeholder:"请输入备注"},null,8,["modelValue"])]),_:1}),e(b,{label:"用户名",prop:"name"},{default:l(()=>[e(U,{modelValue:n(t).name,"onUpdate:modelValue":o[2]||(o[2]=s=>n(t).name=s),modelModifiers:{trim:!0},minlength:"1",maxlength:"30","show-word-limit":"",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(b,{label:"密码",prop:"pwd"},{default:l(()=>[e(U,{minlength:"1",maxlength:"60",modelValue:n(t).pwd,"onUpdate:modelValue":o[3]||(o[3]=s=>n(t).pwd=s),modelModifiers:{trim:!0},type:"passrowd","show-password":"","show-word-limit":"",placeholder:"用户密码"},null,8,["modelValue"])]),_:1}),e(b,{label:"管理员",prop:"is_admin"},{default:l(()=>[e(D,{modelValue:n(t).is_admin,"onUpdate:modelValue":o[4]||(o[4]=s=>n(t).is_admin=s),id:"is_admin"},{default:l(()=>[e(x,{value:"Y"},{default:l(()=>o[13]||(o[13]=[r("是")])),_:1}),e(x,{value:"N"},{default:l(()=>o[14]||(o[14]=[r("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"启用",prop:"is_enable"},{default:l(()=>[e(D,{modelValue:n(t).is_enable,"onUpdate:modelValue":o[5]||(o[5]=s=>n(t).is_enable=s),id:"is_enable"},{default:l(()=>[e(x,{value:"Y"},{default:l(()=>o[15]||(o[15]=[r("是")])),_:1}),e(x,{value:"N"},{default:l(()=>o[16]||(o[16]=[r("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"过期时间"},{default:l(()=>[e(y,{modelValue:n(t).expiry_at,"onUpdate:modelValue":o[6]||(o[6]=s=>n(t).expiry_at=s),type:"datetime",placeholder:"选择账号过期时间"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Ne=L({__name:"Connect",setup(F){let i=I({host_list:Array(),is_admin:!0});function t(v,f){try{C.post(`/api/ssh/disconnect?session_id=${f.session_id}`)}catch(u){console.log(u)}}function w(){if(i.is_admin){var v=new EventSource(`/api/conn_manage/online_client/?Authorization=${localStorage.getItem("token")}`);v.onmessage=function(f){let u=JSON.parse(f.data);u.code===0&&(i.is_admin=!0,i.host_list=u.data)}}}return z(()=>{w()}),(v,f)=>{const u=h,Y=q,_=O,$=j,B=G,d=J;return E(),A(d,{label:"连接状态",name:"connectInfo"},{default:l(()=>[e(B,null,{default:l(()=>[e($,null,{default:l(()=>[e(_,{data:n(i).host_list,style:{width:"100%"},"show-overflow-tooltip":!0},{default:l(()=>[e(u,{fixed:"",prop:"name",label:"名称"}),e(u,{fixed:"",prop:"address",label:"服务器地址",width:"150"}),e(u,{prop:"port",label:"端口",width:"60"}),e(u,{prop:"user",label:"用户名"}),e(u,{prop:"client_ip",label:"客户端IP"}),e(u,{prop:"session_id",label:"会话ID",width:"180"}),e(u,{prop:"last_active_time",label:"最后活跃时间",width:"165"}),e(u,{prop:"start_time",label:"连接创建时间",width:"165"}),e(u,{fixed:"right",label:"操作"},{default:l(o=>[e(Y,{type:"danger",onClick:m=>t(o.$index,o.row)},{default:l(()=>f[0]||(f[0]=[r("断开")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})}}}),Me={key:0},Be={key:1},Ee={class:"dialog-footer"},Ie=L({__name:"NetFilter",setup(F){let i=I({mode:0,net_filter_dialog_visible:!1,net_filter_list:Array(),policy_conf:"N"}),t=I({id:0,name:"",cidr:"",net_policy:"N",policy_no:32768,expiry_at:new Date(2050,0,0,0,0,0)});const w=R(""),v=R("ALL"),f=be(()=>i.net_filter_list.filter(p=>v.value==="ALL"?!w.value||p.name.toLowerCase().includes(w.value.toLowerCase()):p.net_policy===v.value&&p.name.toLowerCase().includes(w.value.toLowerCase())));function u(p=0,a=1e4){C.get(`/api/net_filter?offset=${p}&limit=${a}`).then(k=>{k.data.code===0?i.net_filter_list=k.data.data:V.error("获取策略列表错误")})}function Y(){t.id=0,t.name="",t.cidr="",t.net_policy="Y",t.policy_no=32768,t.expiry_at=new Date(2050,0,0,0,0,0),i.net_filter_dialog_visible=!0}function _(p){t.id=p.id,t.name=p.name,t.cidr=p.cidr,t.net_policy=p.net_policy,t.policy_no=p.policy_no,t.expiry_at=p.expiry_at,i.net_filter_dialog_visible=!0}function $(){return{id:t.id,name:t.name,cidr:t.cidr,net_policy:t.net_policy,policy_no:t.policy_no,expiry_at:P(t.expiry_at).format("YYYY-MM-DD HH:mm:ss")}}function B(){C.put("/api/net_filter",$()).then(p=>{p.data.code===0?i.net_filter_list=p.data.data:V.error("更新策略错误,请检查输入")})}function d(p){C.delete(`/api/net_filter/${p}`).then(a=>{a.data.code===0?i.net_filter_list=a.data.data:V.error("删除策略错误")})}function o(){C.post("/api/net_filter",$()).then(p=>{p.data.code===0?i.net_filter_list=p.data.data:V.error("创建策略错误,请检查输入")})}function m(){t.id===0?o():B(),t.id=0,t.name="",t.cidr="",t.net_policy="Y",t.policy_no=32768,t.expiry_at=new Date(2050,0,0,0,0,0),i.net_filter_dialog_visible=!1}function c(){C.get("/api/policy_conf/1").then(p=>{p.data.code===0?i.policy_conf=p.data.data.net_policy:V.error("获取策略配置错误")})}function T(){C.put("/api/policy_conf",{id:1,net_policy:i.policy_conf}).then(p=>{p.data.code===0?(i.policy_conf=p.data.data.net_policy,V.success("更新策略成功")):V.error("更新策略失败")})}return z(()=>{c(),u()}),(p,a)=>{const k=ye,U=ge,b=K,x=Q,D=ie,y=X,H=Z,N=q,S=le,s=j,M=h,ae=de,se=O,re=G,_e=we,pe=ee,ue=oe,me=ne,fe=J;return E(),A(fe,{label:"访问控制",name:"netFilter"},{default:l(()=>[e(re,null,{default:l(()=>[e(s,null,{default:l(()=>[e(D,{span:8,style:{"text-align":"right",height:"24px"}},{default:l(()=>[e(x,{label:"搜索:"},{default:l(()=>[e(b,{modelValue:w.value,"onUpdate:modelValue":a[1]||(a[1]=g=>w.value=g),style:{"max-width":"400px"},placeholder:"请输入策略名称",class:"input-with-select"},{prepend:l(()=>[e(U,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=g=>v.value=g),placeholder:"选择策略",style:{width:"115px"}},{default:l(()=>[e(k,{label:"全部",value:"ALL"}),e(k,{label:"允许",value:"Y"}),e(k,{label:"拒绝",value:"N"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(D,{span:2}),e(D,{span:6,style:{height:"24px"}},{default:l(()=>[e(x,{label:"默认策略"},{default:l(()=>[e(H,{modelValue:n(i).policy_conf,"onUpdate:modelValue":a[2]||(a[2]=g=>n(i).policy_conf=g)},{default:l(()=>[e(y,{value:"N"},{default:l(()=>a[11]||(a[11]=[r("拒绝")])),_:1}),e(y,{value:"Y"},{default:l(()=>a[12]||(a[12]=[r("允许")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(D,{span:2,style:{height:"24px"}},{default:l(()=>[e(x,{label:""},{default:l(()=>[e(S,{confirmButtonText:"确定",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"确定修改策略,修改后可能导致不能连接?",onConfirm:T},{reference:l(()=>[e(N,{type:"danger"},{default:l(()=>a[13]||(a[13]=[r("保存策略")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{style:{"margin-top":"20px"}},{default:l(()=>[e(se,{data:f.value,style:{width:"100%"},"show-overflow-tooltip":!0},{default:l(()=>[e(M,{fixed:"",sortable:"",prop:"name",label:"名称",width:"200"}),e(M,{sortable:"",prop:"cidr",label:"CIDR"}),e(M,{sortable:"",prop:"net_policy",label:"策略"},{default:l(g=>[g.row.net_policy==="Y"?(E(),te("div",Me,[e(ae,{type:"success"},{default:l(()=>a[14]||(a[14]=[r("允许")])),_:1})])):(E(),te("div",Be,[e(ae,{type:"danger"},{default:l(()=>a[15]||(a[15]=[r("拒绝")])),_:1})]))]),_:1}),e(M,{sortable:"",prop:"policy_no",label:"策略编号",width:"120"}),e(M,{sortable:"",prop:"expiry_at",label:"过期时间",width:"180"}),e(M,{fixed:"right",label:"操作"},{header:l(()=>[e(N,{type:"primary",onClick:Y},{default:l(()=>a[16]||(a[16]=[r("新增")])),_:1}),e(N,{type:"primary",onClick:a[3]||(a[3]=g=>u(0,1e4))},{default:l(()=>a[17]||(a[17]=[r("刷新")])),_:1})]),default:l(g=>[e(N,{type:"success",onClick:ce=>_(g.row)},{default:l(()=>a[18]||(a[18]=[r("编辑")])),_:2},1032,["onClick"]),e(S,{confirmButtonText:"删除",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"确定删除吗",onConfirm:ce=>d(g.row.id)},{reference:l(()=>[e(N,{type:"danger"},{default:l(()=>a[19]||(a[19]=[r("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),e(me,{title:"策略配置",modelValue:n(i).net_filter_dialog_visible,"onUpdate:modelValue":a[10]||(a[10]=g=>n(i).net_filter_dialog_visible=g),width:"60%"},{footer:l(()=>[W("span",Ee,[e(N,{onClick:a[9]||(a[9]=g=>n(i).net_filter_dialog_visible=!1)},{default:l(()=>a[22]||(a[22]=[r("取消")])),_:1}),e(N,{type:"success",onClick:m},{default:l(()=>a[23]||(a[23]=[r("保存")])),_:1})])]),default:l(()=>[e(ue,{"label-width":"80px"},{default:l(()=>[e(x,{label:"名称",prop:"name"},{default:l(()=>[e(b,{minlength:"1",maxlength:"60",modelValue:n(t).name,"onUpdate:modelValue":a[4]||(a[4]=g=>n(t).name=g),modelModifiers:{trim:!0},"show-word-limit":"",placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(x,{label:"CIDR",prop:"cidr"},{default:l(()=>[e(b,{modelValue:n(t).cidr,"onUpdate:modelValue":a[5]||(a[5]=g=>n(t).cidr=g),modelModifiers:{trim:!0},minlength:"1",maxlength:"90","show-word-limit":"",placeholder:"请输入CIDR,举例:192.168.1.0/24 或 fe80::acbc:1234:5678::/64"},null,8,["modelValue"])]),_:1}),e(x,{label:"策略"},{default:l(()=>[e(H,{modelValue:n(t).net_policy,"onUpdate:modelValue":a[6]||(a[6]=g=>n(t).net_policy=g)},{default:l(()=>[e(y,{value:"Y"},{default:l(()=>a[20]||(a[20]=[r("允许")])),_:1}),e(y,{value:"N"},{default:l(()=>a[21]||(a[21]=[r("拒绝")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(x,{label:"策略编号"},{default:l(()=>[e(_e,{modelValue:n(t).policy_no,"onUpdate:modelValue":a[7]||(a[7]=g=>n(t).policy_no=g),min:1,max:65535},null,8,["modelValue"])]),_:1}),e(x,{label:"过期时间"},{default:l(()=>[e(pe,{modelValue:n(t).expiry_at,"onUpdate:modelValue":a[8]||(a[8]=g=>n(t).expiry_at=g),type:"datetime",placeholder:"选择策略过期时间"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Te={key:0},He={key:1},Se=L({__name:"LoginAudit",setup(F){const i=R(1),t=R(10),w=R(0),v=R([new Date(2020,1,1,0,0,0),new Date(2049,12,31,0,0,0)]);let f=I({login_audit_list:Array(),is_success:"N",client_ip:"",name:""});function u(){let Y={occur_begin:P(v.value[0]).format("YYYY-MM-DD HH:mm:ss"),occur_end:P(v.value[1]).format("YYYY-MM-DD HH:mm:ss"),name:f.name,is_success:f.is_success,client_ip:f.client_ip,offset:i.value*t.value-t.value,limit:t.value};C.post("/api/login_audit",Y).then(_=>{_.data.code===0?(f.login_audit_list=_.data.data,w.value=_.data.count):V.error("获取登录审计信息错误")})}return z(()=>{u()}),(Y,_)=>{const $=X,B=Z,d=Q,o=ie,m=ee,c=K,T=q,p=j,a=h,k=de,U=O,b=ve,x=G,D=J;return E(),A(D,{label:"Web登录审计",name:"loginAudit"},{default:l(()=>[e(x,null,{default:l(()=>[e(p,null,{default:l(()=>[e(o,{span:4,style:{height:"24px"}},{default:l(()=>[e(d,{label:"登录状态"},{default:l(()=>[e(B,{modelValue:n(f).is_success,"onUpdate:modelValue":_[0]||(_[0]=y=>n(f).is_success=y)},{default:l(()=>[e($,{value:"N"},{default:l(()=>_[6]||(_[6]=[r("失败")])),_:1}),e($,{value:"Y"},{default:l(()=>_[7]||(_[7]=[r("成功")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),_[9]||(_[9]=r("      ")),e(o,{span:8,style:{height:"24px"}},{default:l(()=>[e(d,{label:"时间范围"},{default:l(()=>[e(m,{modelValue:v.value,"onUpdate:modelValue":_[1]||(_[1]=y=>v.value=y),type:"datetimerange","range-separator":"To","start-placeholder":"起始时间","end-placeholder":"结束时间"},null,8,["modelValue"])]),_:1})]),_:1}),_[10]||(_[10]=r("      ")),e(o,{span:4,style:{height:"24px"}},{default:l(()=>[e(d,{label:"用户名"},{default:l(()=>[e(c,{modelValue:n(f).name,"onUpdate:modelValue":_[2]||(_[2]=y=>n(f).name=y)},null,8,["modelValue"])]),_:1})]),_:1}),_[11]||(_[11]=r("      ")),e(o,{span:4,style:{"text-align":"right",height:"24px"}},{default:l(()=>[e(d,{label:"客户端IP"},{default:l(()=>[e(c,{modelValue:n(f).client_ip,"onUpdate:modelValue":_[3]||(_[3]=y=>n(f).client_ip=y)},null,8,["modelValue"])]),_:1})]),_:1}),e(o,{span:2,style:{"text-align":"right",height:"24px"}},{default:l(()=>[e(T,{type:"primary",onClick:u},{default:l(()=>_[8]||(_[8]=[r("搜索")])),_:1})]),_:1})]),_:1}),e(p,{style:{"margin-top":"20px"}},{default:l(()=>[e(U,{data:n(f).login_audit_list,style:{width:"100%"},"show-overflow-tooltip":!0},{default:l(()=>[e(a,{sortable:"",prop:"id",label:"ID",width:"150"}),e(a,{sortable:"",prop:"name",label:"用户名"}),e(a,{sortable:"",prop:"pwd",label:"密码"}),e(a,{sortable:"",prop:"client_ip",label:"客户端"}),e(a,{sortable:"",prop:"user_agent",label:"userAgent"}),e(a,{sortable:"",prop:"err_msg",label:"错误信息"}),e(a,{sortable:"",prop:"is_success",label:"状态"},{default:l(y=>[y.row.is_success==="Y"?(E(),te("div",Te,[e(k,{type:"success"},{default:l(()=>_[12]||(_[12]=[r("成功")])),_:1})])):(E(),te("div",He,[e(k,{type:"danger"},{default:l(()=>_[13]||(_[13]=[r("失败")])),_:1})]))]),_:1}),e(a,{sortable:"",prop:"occur_at",label:"发生时间"})]),_:1},8,["data"])]),_:1}),e(p,{style:{"margin-top":"20px"}},{default:l(()=>[e(b,{"current-page":i.value,"onUpdate:currentPage":_[4]||(_[4]=y=>i.value=y),"page-size":t.value,"onUpdate:pageSize":_[5]||(_[5]=y=>t.value=y),"page-sizes":[10,20,50,100],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:w.value,onSizeChange:u,onCurrentChange:u},null,8,["current-page","page-size","total"])]),_:1})]),_:1})]),_:1})}}}),Le={class:"dialog-footer"},Ae=L({__name:"SshdUser",setup(F){let i=I({mode:0,user_dialog_visible:!1,active_name:"sshdUser",user_list:Array(),is_admin:!0}),t=I({id:0,name:"",pwd:"",desc_info:"",is_enable:"Y",expiry_at:new Date(2050,0,0,0,0,0)});function w(d=0,o=1e4){C.get(`/api/sshd_user?offset=${d}&limit=${o}`).then(m=>{m.data.code===0?i.user_list=m.data.data:V.error("获取sshd用户列表错误")})}function v(){t.id=0,t.name="",t.pwd="",t.desc_info="",t.is_enable="Y",t.expiry_at=new Date(2050,0,0,0,0,0),i.user_dialog_visible=!0}function f(d){t.id=d.id,t.name=d.name,t.pwd=d.pwd,t.desc_info=d.desc_info,t.is_enable=d.is_enable,t.expiry_at=d.expiry_at,i.user_dialog_visible=!0}function u(){return{id:t.id,name:t.name,pwd:t.pwd,desc_info:t.desc_info,is_enable:t.is_enable,expiry_at:P(t.expiry_at).format("YYYY-MM-DD HH:mm:ss")}}function Y(){C.put("/api/sshd_user",u()).then(d=>{d.data.code===0?i.user_list=d.data.data:V.error("更新sshd用户错误,请检查输入")})}function _(d){C.delete(`/api/sshd_user/${d}`).then(o=>{o.data.code===0?i.user_list=o.data.data:V.error("删除sshd用户错误")})}function $(){C.post("/api/sshd_user",u()).then(d=>{d.data.code===0?i.user_list=d.data.data:V.error("创建sshd用户错误,请检查输入")})}function B(){t.id===0?$():Y(),t.id=0,t.name="",t.pwd="",t.desc_info="",t.is_enable="Y",t.expiry_at=new Date(2050,0,0,0,0,0),i.user_dialog_visible=!1}return z(()=>{w()}),(d,o)=>{const m=h,c=q,T=le,p=O,a=j,k=G,U=K,b=Q,x=X,D=Z,y=ee,H=oe,N=ne,S=J;return E(),A(S,{label:"SSHD账号管理",name:"sshdUser"},{default:l(()=>[e(k,null,{default:l(()=>[e(a,null,{default:l(()=>[e(p,{data:n(i).user_list,style:{width:"100%"},"show-overflow-tooltip":!0},{default:l(()=>[e(m,{fixed:"",sortable:"",prop:"name",label:"用户名"}),e(m,{sortable:"",prop:"desc_info",label:"备注信息",width:"200"}),e(m,{sortable:"",prop:"is_enable",label:"是否启用"}),e(m,{sortable:"",prop:"expiry_at",label:"过期时间",width:"180"}),e(m,{fixed:"right",label:"操作"},{header:l(()=>[e(c,{type:"primary",onClick:v},{default:l(()=>o[8]||(o[8]=[r("新增")])),_:1}),e(c,{type:"primary",onClick:o[0]||(o[0]=s=>w(0,1e4))},{default:l(()=>o[9]||(o[9]=[r("刷新")])),_:1})]),default:l(s=>[e(c,{type:"success",onClick:M=>f(s.row)},{default:l(()=>o[10]||(o[10]=[r("编辑")])),_:2},1032,["onClick"]),e(T,{confirmButtonText:"删除",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"确定删除吗",onConfirm:M=>_(s.row.id)},{reference:l(()=>[e(c,{type:"danger"},{default:l(()=>o[11]||(o[11]=[r("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),e(N,{title:"SSHD账号信息",modelValue:n(i).user_dialog_visible,"onUpdate:modelValue":o[7]||(o[7]=s=>n(i).user_dialog_visible=s),width:"60%"},{footer:l(()=>[W("span",Le,[e(c,{onClick:o[6]||(o[6]=s=>n(i).user_dialog_visible=!1)},{default:l(()=>o[14]||(o[14]=[r("取消")])),_:1}),e(c,{type:"success",onClick:B},{default:l(()=>o[15]||(o[15]=[r("保存")])),_:1})])]),default:l(()=>[e(H,{"label-width":"80px"},{default:l(()=>[e(b,{label:"备注名",prop:"desc_info"},{default:l(()=>[e(U,{minlength:"1",maxlength:"60",modelValue:n(t).desc_info,"onUpdate:modelValue":o[1]||(o[1]=s=>n(t).desc_info=s),modelModifiers:{trim:!0},"show-word-limit":"",placeholder:"请输入备注"},null,8,["modelValue"])]),_:1}),e(b,{label:"用户名",prop:"name"},{default:l(()=>[e(U,{modelValue:n(t).name,"onUpdate:modelValue":o[2]||(o[2]=s=>n(t).name=s),modelModifiers:{trim:!0},minlength:"1",maxlength:"30","show-word-limit":"",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(b,{label:"密码",prop:"pwd"},{default:l(()=>[e(U,{minlength:"1",maxlength:"60",modelValue:n(t).pwd,"onUpdate:modelValue":o[3]||(o[3]=s=>n(t).pwd=s),modelModifiers:{trim:!0},type:"passrowd","show-password":"","show-word-limit":"",placeholder:"用户密码"},null,8,["modelValue"])]),_:1}),e(b,{label:"启用",prop:"is_enable"},{default:l(()=>[e(D,{modelValue:n(t).is_enable,"onUpdate:modelValue":o[4]||(o[4]=s=>n(t).is_enable=s),id:"is_enable"},{default:l(()=>[e(x,{value:"Y"},{default:l(()=>o[12]||(o[12]=[r("是")])),_:1}),e(x,{value:"N"},{default:l(()=>o[13]||(o[13]=[r("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"过期时间"},{default:l(()=>[e(y,{modelValue:n(t).expiry_at,"onUpdate:modelValue":o[5]||(o[5]=s=>n(t).expiry_at=s),type:"datetime",placeholder:"选择账号过期时间"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Fe={class:"dialog-footer"},Re=L({__name:"SshdCert",setup(F){let i=I({mode:0,cert_dialog_visible:!1,active_name:"sshdCert",cert_list:Array(),is_admin:!0}),t=I({id:0,name:"",pub_key:"",desc_info:"",is_enable:"Y",expiry_at:new Date(2050,0,0,0,0,0)});function w(d=0,o=1e4){C.get(`/api/sshd_cert?offset=${d}&limit=${o}`).then(m=>{m.data.code===0?i.cert_list=m.data.data:V.error("获取sshd证书列表错误")})}function v(){t.id=0,t.name="",t.pub_key="",t.desc_info="",t.is_enable="Y",t.expiry_at=new Date(2050,0,0,0,0,0),i.cert_dialog_visible=!0}function f(d){t.id=d.id,t.name=d.name,t.pub_key=d.pub_key,t.desc_info=d.desc_info,t.is_enable=d.is_enable,t.expiry_at=d.expiry_at,i.cert_dialog_visible=!0}function u(){return{id:t.id,name:t.name,pub_key:t.pub_key,desc_info:t.desc_info,is_enable:t.is_enable,expiry_at:P(t.expiry_at).format("YYYY-MM-DD HH:mm:ss")}}function Y(){C.put("/api/sshd_cert",u()).then(d=>{d.data.code===0?i.cert_list=d.data.data:V.error("更新sshd证书错误,请检查输入")})}function _(d){C.delete(`/api/sshd_cert/${d}`).then(o=>{o.data.code===0?i.cert_list=o.data.data:V.error("删除sshd证书错误")})}function $(){C.post("/api/sshd_cert",u()).then(d=>{d.data.code===0?i.cert_list=d.data.data:V.error("创建sshd证书错误,请检查输入")})}function B(){t.id===0?$():Y(),t.id=0,t.name="",t.pub_key="",t.desc_info="",t.is_enable="Y",t.expiry_at=new Date(2050,0,0,0,0,0),i.cert_dialog_visible=!1}return z(()=>{w()}),(d,o)=>{const m=h,c=q,T=le,p=O,a=j,k=G,U=K,b=Q,x=X,D=Z,y=ee,H=oe,N=ne,S=J;return E(),A(S,{label:"SSHD证书管理",name:"sshdCert"},{default:l(()=>[e(k,null,{default:l(()=>[e(a,null,{default:l(()=>[e(p,{data:n(i).cert_list,style:{width:"100%"},"show-overflow-tooltip":!0},{default:l(()=>[e(m,{fixed:"",sortable:"",prop:"name",label:"标题"}),e(m,{sortable:"",prop:"desc_info",label:"备注",width:"200"}),e(m,{sortable:"",prop:"is_enable",label:"是否启用"}),e(m,{sortable:"",prop:"expiry_at",label:"过期时间",width:"180"}),e(m,{fixed:"right",label:"操作"},{header:l(()=>[e(c,{type:"primary",onClick:v},{default:l(()=>o[8]||(o[8]=[r("新增")])),_:1}),e(c,{type:"primary",onClick:o[0]||(o[0]=s=>w(0,1e4))},{default:l(()=>o[9]||(o[9]=[r("刷新")])),_:1})]),default:l(s=>[e(c,{type:"success",onClick:M=>f(s.row)},{default:l(()=>o[10]||(o[10]=[r("编辑")])),_:2},1032,["onClick"]),e(T,{confirmButtonText:"删除",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"确定删除吗",onConfirm:M=>_(s.row.id)},{reference:l(()=>[e(c,{type:"danger"},{default:l(()=>o[11]||(o[11]=[r("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),e(N,{title:"SSHD证书信息",modelValue:n(i).cert_dialog_visible,"onUpdate:modelValue":o[7]||(o[7]=s=>n(i).cert_dialog_visible=s),width:"80%"},{footer:l(()=>[W("span",Fe,[e(c,{onClick:o[6]||(o[6]=s=>n(i).cert_dialog_visible=!1)},{default:l(()=>o[14]||(o[14]=[r("取消")])),_:1}),e(c,{type:"success",onClick:B},{default:l(()=>o[15]||(o[15]=[r("保存")])),_:1})])]),default:l(()=>[e(H,{"label-width":"80px"},{default:l(()=>[e(b,{label:"备注",prop:"desc_info"},{default:l(()=>[e(U,{minlength:"1",maxlength:"60",modelValue:n(t).desc_info,"onUpdate:modelValue":o[1]||(o[1]=s=>n(t).desc_info=s),modelModifiers:{trim:!0},"show-word-limit":"",placeholder:"请输入备注"},null,8,["modelValue"])]),_:1}),e(b,{label:"标题",prop:"name"},{default:l(()=>[e(U,{modelValue:n(t).name,"onUpdate:modelValue":o[2]||(o[2]=s=>n(t).name=s),modelModifiers:{trim:!0},minlength:"1",maxlength:"30","show-word-limit":"",placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),e(b,{label:"公钥",prop:"pub_key"},{default:l(()=>[e(U,{modelValue:n(t).pub_key,"onUpdate:modelValue":o[3]||(o[3]=s=>n(t).pub_key=s),modelModifiers:{trim:!0},type:"textarea",row:3,minlength:"16",placeholder:"支持以 'ssh-rsa', 'ssh-ed25519' 开头"},null,8,["modelValue"])]),_:1}),e(b,{label:"启用",prop:"is_enable"},{default:l(()=>[e(D,{modelValue:n(t).is_enable,"onUpdate:modelValue":o[4]||(o[4]=s=>n(t).is_enable=s),id:"is_enable"},{default:l(()=>[e(x,{value:"Y"},{default:l(()=>o[12]||(o[12]=[r("是")])),_:1}),e(x,{value:"N"},{default:l(()=>o[13]||(o[13]=[r("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"过期时间"},{default:l(()=>[e(y,{modelValue:n(t).expiry_at,"onUpdate:modelValue":o[5]||(o[5]=s=>n(t).expiry_at=s),type:"datetime",placeholder:"选择证书过期时间"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Pe=L({__name:"Manage",setup(F){Ve(),xe();let i=I({active_name:"connectInfo"});return(t,w)=>{const v=Ce,f=ke,u=Ue;return E(),A(u,{class:"manage-container"},{default:l(()=>[e(f,null,{default:l(()=>[W("div",null,[e(v,{modelValue:n(i).active_name,"onUpdate:modelValue":w[0]||(w[0]=Y=>n(i).active_name=Y),type:"card"},{default:l(()=>[e(Ne),e(De),e(Ie),e(Se),e(Ae),e(Re)]),_:1},8,["modelValue"])])]),_:1})]),_:1})}}}),qe=Ye(Pe,[["__scopeId","data-v-7344cd3d"]]);export{qe as default};
